I. Synchronized khÃ¡c vá»›i Asyn cá»§a C#:
ğŸŸ¨ 1. synchronized lÃ  gÃ¬?
**synchronized** lÃ  má»™t tá»« khÃ³a trong Java dÃ¹ng Ä‘á»ƒ Ä‘á»“ng bá»™ hÃ³a nhiá»u luá»“ng truy cáº­p cÃ¹ng má»™t lÃºc Ä‘áº¿n má»™t tÃ i nguyÃªn dÃ¹ng chung.

âœ… Má»¥c tiÃªu: TrÃ¡nh race condition â€” khi hai hoáº·c nhiá»u thread cÃ¹ng thay Ä‘á»•i dá»¯ liá»‡u táº¡i cÃ¹ng thá»i Ä‘iá»ƒm, gÃ¢y ra lá»—i logic hoáº·c dá»¯ liá»‡u sai lá»‡ch.

ğŸ”§ 2. CÃ¡ch hoáº¡t Ä‘á»™ng
Khi má»™t thread vÃ o vÃ¹ng synchronized, nÃ³ sáº½ khÃ³a (lock) Ä‘á»‘i tÆ°á»£ng (object hoáº·c class) Ä‘Æ°á»£c Ä‘á»“ng bá»™ hÃ³a. CÃ¡c thread khÃ¡c muá»‘n vÃ o pháº£i chá» Ä‘áº¿n khi thread hiá»‡n táº¡i thoÃ¡t ra vÃ  nháº£ lock.

ğŸ§± 3. CÃ¡c cÃ¡ch dÃ¹ng synchronized
ğŸ“ a. Synchronized Method (phÆ°Æ¡ng thá»©c Ä‘á»“ng bá»™)
public synchronized void increaseCounter() {
    counter++;
}
KhÃ³a (lock) lÃ  this (Ä‘á»‘i tÆ°á»£ng hiá»‡n táº¡i).

Chá»‰ 1 thread Ä‘Æ°á»£c cháº¡y phÆ°Æ¡ng thá»©c nÃ y táº¡i má»™t thá»i Ä‘iá»ƒm trÃªn cÃ¹ng má»™t object.

ğŸ“ b. Synchronized Block (khá»‘i Ä‘á»“ng bá»™ hÃ³a)
public void increaseCounter() {
    synchronized (this) {
        counter++;
    }
}
KhÃ³a thá»§ cÃ´ng má»™t Ä‘oáº¡n code, giÃºp tá»‘i Æ°u hÆ¡n vÃ¬ khÃ´ng pháº£i khÃ³a cáº£ hÃ m.

ğŸ“ c. Synchronized trÃªn static method
public static synchronized void logData() {
    // Do something
}
KhÃ³a lÃ  class object (class-level lock, khÃ´ng pháº£i instance-level).

ğŸš¦ 4. VÃ­ dá»¥ minh hoáº¡ Ä‘Æ¡n giáº£n
public class Counter {
    private int count = 0;

    public synchronized void increase() {
        count++;
    }

    public int getCount() {
        return count;
    }
}
VÃ  dÃ¹ng nhiá»u thread:


Counter counter = new Counter();

Thread t1 = new Thread(() -> {
    for (int i = 0; i < 1000; i++) counter.increase();
});

Thread t2 = new Thread(() -> {
    for (int i = 0; i < 1000; i++) counter.increase();
});

t1.start();
t2.start();
t1.join();
t2.join();

System.out.println(counter.getCount()); => Cháº¯c cháº¯n in ra 2000

Náº¿u khÃ´ng dÃ¹ng synchronized thÃ¬ káº¿t quáº£ lÃ :
Báº¡n Ä‘ang há»i:

"DÃ¹ cÃ³ synchronized hay khÃ´ng thÃ¬ sau khi t1.join() vÃ  t2.join() xong má»›i in káº¿t quáº£. Váº­y sao láº¡i cáº§n synchronized? Cháº³ng pháº£i khi in thÃ¬ cáº£ hai thread Ä‘Ã£ cháº¡y xong háº¿t rá»“i sao? In ra 2000 lÃ  Ä‘Æ°Æ¡ng nhiÃªn chá»©?"

=> â— Sai láº§m náº±m á»Ÿ chá»— tÆ°á»Ÿng ráº±ng náº¿u t1 vÃ  t2 Ä‘Ã£ cháº¡y xong thÃ¬ cháº¯c cháº¯n biáº¿n counter Ä‘Ã£ tÄƒng Ä‘Ãºng 2000 láº§n. NhÆ°ng thá»±c táº¿ khÃ´ng pháº£i váº­y, vÃ  Ä‘Ã³ lÃ  lÃ½ do cáº§n synchronized. CÃ¹ng mÃ¬nh phÃ¢n tÃ­ch chi tiáº¿t nhÃ©:

ğŸ’¥ Váº¥n Ä‘á»: Race Condition
â“ Chuyá»‡n gÃ¬ xáº£y ra khi KHÃ”NG dÃ¹ng synchronized?
Giáº£ sá»­ 2 thread cÃ¹ng tÄƒng counter:

counter++;
Thá»±c cháº¥t dÃ²ng counter++ khÃ´ng pháº£i lÃ  má»™t lá»‡nh duy nháº¥t mÃ  lÃ  3 bÆ°á»›c:

Äá»c giÃ¡ trá»‹ counter tá»« RAM vÃ o CPU register

TÄƒng giÃ¡ trá»‹ trong register

Ghi giÃ¡ trá»‹ tÄƒng vÃ o láº¡i RAM

â†’ Náº¿u 2 thread cÃ¹ng thá»±c hiá»‡n counter++ mÃ  khÃ´ng Ä‘á»“ng bá»™, ta cÃ³ thá»ƒ bá»‹ nhÆ° sau:


Thread 1 Ä‘á»c	Thread 2 Ä‘á»c	Cáº£ 2 tÄƒng	Cáº£ 2 ghi	Káº¿t quáº£
    0	   	    0		   1		   1		âŒ Máº¥t 1 láº§n tÄƒng
â¡ï¸ DÃ¹ 2 thread cháº¡y 1000 láº§n má»—i bÃªn = 2000 láº§n tÄƒng, nhÆ°ng vÃ¬ tranh cháº¥p bá»™ nhá»›, cÃ³ thá»ƒ máº¥t má»™t sá»‘ láº§n tÄƒng â†’ káº¿t quáº£ nhá» hÆ¡n 2000.

âœ… DÃ¹ng synchronized Ä‘á»ƒ trÃ¡nh Ä‘iá»u Ä‘Ã³
Vá»›i synchronized, chá»‰ má»™t thread Ä‘Æ°á»£c phÃ©p cháº¡y vÃ o pháº§n counter++ táº¡i má»™t thá»i Ä‘iá»ƒm.

â†’ CÃ¡c thao tÃ¡c Ä‘á»c-tÄƒng-ghi sáº½ khÃ´ng bá»‹ "chen ngang", Ä‘áº£m báº£o Ä‘Ãºng sá»‘ lÆ°á»£ng tÄƒng.

ğŸ§ª Thá»­ nghiá»‡m thá»±c táº¿
Náº¿u báº¡n bá» synchronized vÃ  cháº¡y thá»­ Ä‘oáº¡n nÃ y nhiá»u láº§n:


public class Counter {
    private int count = 0;

    public void increase() {
        count++;
    }

    public int getCount() {
        return count;
    }
}
Káº¿t quáº£ in ra cÃ³ thá»ƒ lÃ  1897, 1944, 1982..., khÃ´ng pháº£i 2000. Tuá»³ theo mÃ¡y báº¡n, thread scheduler, CPU... NÃ³ khÃ´ng sai cÃº phÃ¡p, nhÆ°ng sai logic (bug logic do Ä‘a luá»“ng).


-----------------------------------------------------------------------------------------------------------------


ğŸŸ© 2. native trong Java lÃ  gÃ¬?
native lÃ  má»™t tá»« khÃ³a trong Java dÃ¹ng Ä‘á»ƒ káº¿t ná»‘i Ä‘áº¿n code viáº¿t báº±ng ngÃ´n ngá»¯ khÃ¡c (thÆ°á»ng lÃ  C hoáº·c C++).

ğŸ“Œ Khi báº¡n khai bÃ¡o má»™t phÆ°Æ¡ng thá»©c lÃ  native, nghÄ©a lÃ  pháº§n thÃ¢n (implementation) khÃ´ng viáº¿t báº±ng Java, mÃ  viáº¿t á»Ÿ má»™t nÆ¡i khÃ¡c (thÆ°á»ng lÃ  C/C++ thÃ´ng qua JNI).


-----------------------------------------------------------------------------------------------------------------


ğŸ”¥3. throw â€“ nÃ©m ra má»™t ngoáº¡i lá»‡ cá»¥ thá»ƒ
DÃ¹ng Ä‘á»ƒ táº¡o vÃ  nÃ©m (gÃ¢y ra) má»™t ngoáº¡i lá»‡ (exception).

ThÆ°á»ng dÃ¹ng trong pháº§n thÃ¢n cá»§a method.

ğŸ”¹ CÃº phÃ¡p:
java
Sao chÃ©p
Chá»‰nh sá»­a
throw new Exception("Lá»—i rá»“i!");âš ï¸ throws â€“ khai bÃ¡o ráº±ng method cÃ³ thá»ƒ nÃ©m ra ngoáº¡i lá»‡
DÃ¹ng á»Ÿ pháº§n khai bÃ¡o method Ä‘á»ƒ nÃ³i ráº±ng method nÃ y cÃ³ thá»ƒ nÃ©m ra ngoáº¡i lá»‡, vÃ  ngÆ°á»i gá»i nÃ³ pháº£i xá»­ lÃ½.

ğŸ”¹ CÃº phÃ¡p:
java
Sao chÃ©p
Chá»‰nh sá»­a
public void myMethod() throws IOException {
    // code cÃ³ thá»ƒ nÃ©m IOException
}
âœ… So sÃ¡nh nhanh:

Thuá»™c tÃ­nh	throw	throws
Vá»‹ trÃ­ dÃ¹ng	Trong thÃ¢n hÃ m	Trong khai bÃ¡o hÃ m
Má»¥c Ä‘Ã­ch	NÃ©m ngoáº¡i lá»‡	Khai bÃ¡o ngoáº¡i lá»‡ cÃ³ thá»ƒ nÃ©m
Táº¡o má»›i exception?	âœ… CÃ³	âŒ KhÃ´ng
Sá»­ dá»¥ng vá»›i	new Exception(...)	TÃªn lá»›p ngoáº¡i lá»‡
ğŸ§  VÃ­ dá»¥:
java
Sao chÃ©p
Chá»‰nh sá»­a
public void checkAge(int age) throws IllegalArgumentException {
    if (age < 18) {
        throw new IllegalArgumentException("ChÆ°a Ä‘á»§ 18 tuá»•i");
    }
}
throws â†’ thÃ´ng bÃ¡o: hÃ m nÃ y cÃ³ thá»ƒ nÃ©m IllegalArgumentException

throw â†’ nÃ©m tháº­t ngoáº¡i lá»‡ Ä‘Ã³ náº¿u Ä‘iá»u kiá»‡n xáº£y ra

-----------------------------------------------------------------------------------------------------------------

ğŸ”4. continue â€“ Bá» qua láº§n láº·p hiá»‡n táº¡i, cháº¡y tiáº¿p vÃ²ng láº·p má»›i
ğŸ‘‰ DÃ¹ng khi báº¡n muá»‘n bá» qua Ä‘oáº¡n cÃ²n láº¡i cá»§a vÃ²ng láº·p vÃ  tiáº¿p tá»¥c láº·p láº§n tiáº¿p theo.

ğŸ§ª VÃ­ dá»¥:

for (int i = 1; i <= 5; i++) {
    if (i == 3) continue;
    System.out.println(i);
}
â± Káº¿t quáº£:

1
2
4
5â¡ï¸ i == 3 thÃ¬ bá» qua luÃ´n lá»‡nh System.out.println(i), chuyá»ƒn sang i == 4.

â›” break â€“ ThoÃ¡t khá»i vÃ²ng láº·p luÃ´n
ğŸ‘‰ DÃ¹ng khi báº¡n muá»‘n dá»«ng vÃ²ng láº·p hoÃ n toÃ n, khÃ´ng láº·p ná»¯a.

ğŸ§ª VÃ­ dá»¥:

for (int i = 1; i <= 5; i++) {
    if (i == 3) break;
    System.out.println(i);
}
â± Káº¿t quáº£:

1
2
â¡ï¸ Khi i == 3, gáº·p break, vÃ²ng láº·p dá»«ng ngay láº­p tá»©c.

